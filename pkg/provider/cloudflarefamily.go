package provider

import (
	"net"
	"net/url"
)

type cloudflareFamily struct{}

func CloudflareFamily() Provider {
	return &cloudflareFamily{}
}

func (c *cloudflareFamily) String() string {
	return "Cloudflare Family"
}

func (c *cloudflareFamily) DNS() DNSServer {
	return DNSServer{
		IPv4: []net.IP{{1, 1, 1, 3}, {1, 0, 0, 3}},
		IPv6: []net.IP{
			{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x11, 0x13},
			{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10, 0x03},
		},
	}
}

func (c *cloudflareFamily) DoT() DoTServer {
	return DoTServer{
		IPv4: []net.IP{{1, 1, 1, 3}, {1, 0, 0, 3}},
		IPv6: []net.IP{
			{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x11, 0x13},
			{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10, 0x03},
		},
		Name: "family.cloudflare-dns.com",
		Port: defaultDoTPort,
	}
}

func (c *cloudflareFamily) DoH() DoHServer {
	// see // see https://developers.cloudflare.com/1.1.1.1/1.1.1.1-for-families/setup-instructions/dns-over-https
	return DoHServer{
		URL: &url.URL{
			Scheme: "https",
			Host:   "family.cloudflare-dns.com",
			Path:   "/dns-query",
		},
	}
}
